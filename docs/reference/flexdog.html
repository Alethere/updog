<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flexible genotyping for polyploids from next-generation sequencing data. — flexdog • updog</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Flexible genotyping for polyploids from next-generation sequencing data. — flexdog" />
<meta property="og:description" content="Genotype polyploid individuals from next generation
sequencing (NGS) data while assuming the genotype distribution is one of
several forms. flexdog does this while accounting for allele bias,
overdispersion, sequencing error, and possibly outlying observations
(if model = &quot;f1&quot; or model = &quot;s1&quot;). The method is described
in detail in Gerard et. al. (2018) and Gerard and Ferrão (2019)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">updog</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/oracle_calculations.html">Oracle Calculations</a>
    </li>
    <li>
      <a href="../articles/parallel_computing.html">Parallelized Genotyping using Updog</a>
    </li>
    <li>
      <a href="../articles/simulate_ngs.html">Simulate Next-Generation Sequencing Data</a>
    </li>
    <li>
      <a href="../articles/smells_like_updog.html">Example Use of Updog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flexible genotyping for polyploids from next-generation sequencing data.</h1>
    
    <div class="hidden name"><code>flexdog.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Genotype polyploid individuals from next generation
sequencing (NGS) data while assuming the genotype distribution is one of
several forms. <code>flexdog</code> does this while accounting for allele bias,
overdispersion, sequencing error, and possibly outlying observations
(if <code>model = "f1"</code> or <code>model = "s1"</code>). The method is described
in detail in Gerard et. al. (2018) and Gerard and Ferrão (2019).</p>
    </div>

    <pre class="usage"><span class='fu'>flexdog</span>(<span class='no'>refvec</span>, <span class='no'>sizevec</span>, <span class='no'>ploidy</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"norm"</span>, <span class='st'>"hw"</span>, <span class='st'>"bb"</span>, <span class='st'>"ash"</span>,
  <span class='st'>"s1"</span>, <span class='st'>"s1pp"</span>, <span class='st'>"f1"</span>, <span class='st'>"f1pp"</span>, <span class='st'>"flex"</span>, <span class='st'>"uniform"</span>, <span class='st'>"custom"</span>), <span class='kw'>p1ref</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>p1size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>p2ref</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>p2size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>snpname</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>bias_init</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>, -<span class='fl'>0.5</span>, <span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>)), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>outliers</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>prior_vec</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>refvec</th>
      <td><p>A vector of counts of reads of the reference allele.</p></td>
    </tr>
    <tr>
      <th>sizevec</th>
      <td><p>A vector of total counts.</p></td>
    </tr>
    <tr>
      <th>ploidy</th>
      <td><p>The ploidy of the species. Assumed to be the same for each
individual.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>What form should the prior (genotype distribution) take?
See Details for possible values.</p></td>
    </tr>
    <tr>
      <th>p1ref</th>
      <td><p>The reference counts for the first parent if
<code>model = "f1"</code> (or <code>model = "f1pp"</code>), or for
the only parent if <code>model = "s1"</code> (or <code>model = "s1pp"</code>).</p></td>
    </tr>
    <tr>
      <th>p1size</th>
      <td><p>The total counts for the first parent if
<code>model = "f1"</code> (or <code>model = "f1pp"</code>),
or for the only parent if <code>model = "s1"</code> (or <code>model = "s1pp"</code>).</p></td>
    </tr>
    <tr>
      <th>p2ref</th>
      <td><p>The reference counts for the second parent if
<code>model = "f1"</code> (or <code>model = "f1pp"</code>).</p></td>
    </tr>
    <tr>
      <th>p2size</th>
      <td><p>The total counts for the second parent if
<code>model = "f1"</code> (or <code>model = "f1pp"</code>).</p></td>
    </tr>
    <tr>
      <th>snpname</th>
      <td><p>A string. The name of the SNP under consideration.
This is just returned in the <code>input</code> list for your reference.</p></td>
    </tr>
    <tr>
      <th>bias_init</th>
      <td><p>A vector of initial values for the bias parameter
over the multiple runs of <code>flexdog_full</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Should we output more (<code>TRUE</code>) or less
(<code>FALSE</code>)?</p></td>
    </tr>
    <tr>
      <th>outliers</th>
      <td><p>A logical. Should we allow for the inclusion of outliers
(<code>TRUE</code>) or not (<code>FALSE</code>). Only supported when
<code>model = "f1"</code> or <code>model = "s1"</code>. I wouldn't
recommend it for any other model anyway.</p></td>
    </tr>
    <tr>
      <th>prior_vec</th>
      <td><p>The pre-specified genotype distribution. Only used if
<code>model = "custom"</code> and must otherwise be <code>NULL</code>. If specified,
then it should be a vector of length <code>ploidy + 1</code> with
non-negative elements that sum to 1.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to pass to <code><a href='flexdog_full.html'>flexdog_full</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>flexdog</code>, which consists
    of a list with some or all of the following elements:</p><dl class='dl-horizontal'>
  <dt><code>bias</code></dt><dd><p>The estimated bias parameter.</p></dd>
  <dt><code>seq</code></dt><dd><p>The estimated sequencing error rate.</p></dd>
  <dt><code>od</code></dt><dd><p>The estimated overdispersion parameter.</p></dd>
  <dt><code>num_iter</code></dt><dd><p>The number of EM iterations ran. You should
      be wary if this equals <code>itermax</code>.</p></dd>
  <dt><code>llike</code></dt><dd><p>The maximum marginal log-likelihood.</p></dd>
  <dt><code>postmat</code></dt><dd><p>A matrix of posterior probabilities of each
      genotype for each individual. The rows index the individuals
      and the columns index the allele dosage.</p></dd>
  <dt><code>gene_dist</code></dt><dd><p>The estimated genotype distribution. The
      <code>i</code>th element is the proportion of individuals with
      genotype <code>i-1</code>. If <code>outliers = TRUE</code>, then this
      is conditional on the point not being an outlier.</p></dd>
  <dt><code>par</code></dt><dd><p>A list of the final estimates of the parameters
      of the genotype distribution. The elements included in <code>par</code>
      depends on the value of <code>model</code>:
      <dl class='dl-horizontal'>
      <dt><code>model = "norm"</code>:</dt><dd><p><code>mu</code> is the normal mean and <code>sigma</code>
          is the normal standard deviation (not variance).</p></dd>
      <dt><code>model = "hw"</code>:</dt><dd><p><code>alpha</code> is the major allele frequency.</p></dd>
      <dt><code>model = "bb"</code>:</dt><dd><p><code>alpha</code> is the major allele frequency and
          <code>tau</code> is the overdispersion parameter (see the description of
          <code>rho</code> in the Details of <code><a href='betabinom.html'>betabinom</a></code>).</p></dd>
      <dt><code>model = "ash"</code>:</dt><dd><p><code>par</code> is an empty list.</p></dd>
      <dt><code>model = "s1"</code>:</dt><dd><p><code>pgeno</code> is the allele dosage of the parent and
          <code>alpha</code> is the mixture proportion of the discrete uniform (included and
          fixed at a small value mostly for numerical stability reasons). See the description
          of <code>fs1_alpha</code> in <code><a href='flexdog_full.html'>flexdog_full</a></code>.</p></dd>
      <dt><code>model = "s1pp"</code>:</dt><dd><p><code>pgeno</code> is the allele dosage of the parent and
          <code>p1_pair_weights</code> contains a vector of mixing weights where element <code>i</code> is the
          mixing proportion for the segregation distribution in row <code>i</code> of
          <code>get_bivalent_probs(ploidy)$probmat[get_bivalent_probs(ploidy)$lvec == pgeno, , drop = FALSE]</code>.</p></dd>
      <dt><code>model = "f1"</code>:</dt><dd><p><code>p1geno</code> is the allele dosage of the first parent,
          <code>p2geno</code> is the allele dosage of the second parent, and <code>alpha</code>
          is the mixture proportion of the discrete uniform (included and
          fixed at a small value mostly for numerical stability reasons). See the description
          of <code>fs1_alpha</code> in <code><a href='flexdog_full.html'>flexdog_full</a></code>.</p></dd>
      <dt><code>model = "f1pp"</code>:</dt><dd><p><code>p1geno</code> is the allele dosage of the first parent,
          <code>p2geno</code> is the allele dosage of the second parent,
          <code>p1_pair_weights</code> contains a vector of mixing weights where element <code>i</code> is the
          mixing proportion for the segregation distribution for parent 1 in row <code>i</code> of
          <code>get_bivalent_probs(ploidy)$probmat[get_bivalent_probs(ploidy)$lvec == p1geno, , drop = FALSE]</code>,
          and <code>p2_pair_weights</code> contains a vector of mixing weights where element <code>i</code> is the
          mixing proportion for the segregation distribution for parent 2 in row <code>i</code> of
          <code>get_bivalent_probs(ploidy)$probmat[get_bivalent_probs(ploidy)$lvec == p2geno, , drop = FALSE]</code>.</p></dd>
      <dt><code>model = "flex"</code>:</dt><dd><p><code>par</code> is an empty list.</p></dd>
      <dt><code>model = "uniform"</code>:</dt><dd><p><code>par</code> is an empty list.</p></dd>
      <dt><code>model = "custom"</code>:</dt><dd><p><code>par</code> is an empty list.</p></dd></dl></p></dd>
  <dt><code>geno</code></dt><dd><p>The posterior mode genotype. These are your
      genotype estimates.</p></dd>
  <dt><code>maxpostprob</code></dt><dd><p>The maximum posterior probability. This
      is equivalent to the posterior probability of correctly
      genotyping each individual.</p></dd>
  <dt><code>postmean</code></dt><dd><p>The posterior mean genotype. In downstream
      association studies, you might want to consider using these
      estimates.</p></dd>
  <dt><code>input$refvec</code></dt><dd><p>The value of <code>refvec</code> provided by
      the user.</p></dd>
  <dt><code>input$sizevec</code></dt><dd><p>The value of <code>sizevec</code> provided
      by the user.</p></dd>
  <dt><code>input$ploidy</code></dt><dd><p>The value of <code>ploidy</code> provided
      by the user.</p></dd>
  <dt><code>input$model</code></dt><dd><p>The value of <code>model</code> provided by
      the user.</p></dd>
  <dt><code>input$p1ref</code></dt><dd><p>The value of <code>p1ref</code> provided by the user.</p></dd>
  <dt><code>input$p1size</code></dt><dd><p>The value of <code>p1size</code> provided by the user.</p></dd>
  <dt><code>input$p2ref</code></dt><dd><p>The value of <code>p2ref</code> provided by the user.</p></dd>
  <dt><code>input$p2size</code></dt><dd><p>The value of <code>p2size</code> provided by the user.</p></dd>
  <dt><code>input$snpname</code></dt><dd><p>The value of <code>snpname</code> provided by the user.</p></dd>
  <dt><code>prop_mis</code></dt><dd><p>The posterior proportion of individuals
      genotyped incorrectly.</p></dd>
  <dt><code>out_prop</code></dt><dd><p>The estimated proportion of points that
      are outliers. Only available if <code>outliers = TRUE</code>.</p></dd>
  <dt><code>prob_out</code></dt><dd><p>The ith element is the posterior probability
      that individual i is an outlier. Only available if
      <code>outliers = TRUE</code>.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Possible values of the genotype distribution (values of <code>model</code>) are:</p><dl class='dl-horizontal'>
  <dt><code>"norm"</code></dt><dd><p>A distribution whose genotype frequencies are proportional
      to the density value of a normal with some mean and some standard deviation.
      Unlike the <code>"bb"</code> and <code>"hw"</code> options, this will allow for
      distributions both more and less dispersed than a binomial.
      This seems to be the most robust to violations in modeling assumptions, and so is the
      default. This prior class was developed in Gerard and Ferrão (2019).</p></dd>
  <dt><code>"hw"</code></dt><dd><p>A binomial distribution that results from assuming that
      the population is in Hardy-Weinberg equilibrium (HWE). This actually does
      pretty well even when there are minor to moderate deviations from HWE.
      Though it does not perform as well as the `"norm"` option when there
      are severe deviations from HWE.</p></dd>
  <dt><code>"bb"</code></dt><dd><p>A beta-binomial distribution. This is an overdispersed
      version of <code>"hw"</code> and can be derived from a special case of the Balding-Nichols model.</p></dd>
  <dt><code>"ash"</code></dt><dd><p>Any unimodal prior. This can sometimes be sensitive to violations
      in modeling assumptions, but tends to work better than the <code>"flex"</code> option.
      This prior class was developed in Gerard and Ferrão (2019).</p></dd>
  <dt><code>"s1"</code></dt><dd><p>This prior assumes the individuals are
      all full-siblings resulting
      from one generation of selfing. I.e. there is only
      one parent. This model assumes
      a particular type of meiotic behavior: polysomic
      inheritance with
      bivalent, non-preferential pairing.
      Since this is a pretty strong and well-founded prior,
      we allow <code>outliers = TRUE</code> when <code>model = "s1"</code>.</p></dd>
  <dt><code>"s1pp"</code></dt><dd><p>The same as <code>"s1"</code> but accounts for possible
      (and arbitrary levels of) preferential
      pairing during meiosis. The only supported values of <code>ploidy</code> right now for
      this option are <code>4</code> and <code>6</code>.</p></dd>
  <dt><code>"f1"</code></dt><dd><p>This prior assumes the individuals are all
      full-siblings resulting
      from one generation of a bi-parental cross.
      This model assumes
      a particular type of meiotic behavior: polysomic
      inheritance with
      bivalent, non-preferential pairing. Since this is
      a pretty strong
      and well-founded prior, we allow <code>outliers = TRUE</code>
      when <code>model = "f1"</code>.</p></dd>
  <dt><code>"f1pp"</code></dt><dd><p>The same as <code>"f1"</code> but accounts for possible
      (and arbitrary levels of) preferential
      pairing during meiosis. This option is mostly untested for values of <code>ploidy</code>
      greater than <code>6</code>.</p></dd>
  <dt><code>"flex"</code></dt><dd><p>Generically any categorical distribution. Theoretically,
      this works well if you have a lot of individuals. In practice, it seems to
      be much less robust to violations in modeling assumptions.</p></dd>
  <dt><code>"uniform"</code></dt><dd><p>A discrete uniform distribution. This should never
      be used in practice.</p></dd>
  <dt><code>"custom"</code></dt><dd><p>A pre-specified prior distribution. You specify
      it using the <code>prior_vec</code> argument. You should almost never
      use this option in practice.</p></dd>

</dl>

<p>You might think a good default is <code>model = "uniform"</code> because it is
somehow an "uninformative prior." But it is very informative and tends to
work horribly in practice. The intuition is that it will estimate
the allele bias and sequencing error rates so that the estimated genotypes
are approximately uniform (since we are assuming that they are approximately
uniform). This will usually result in unintuitive genotyping since most
populations don't have a uniform genotype distribution.
I include it as an option only for completeness. Please don't use it.</p>
<p>The value of <code>prop_mis</code> is a very intuitive measure for
the quality of the SNP. <code>prop_mis</code> is the posterior
proportion of individuals mis-genotyped. So if you want only SNPS
that accurately genotype, say, 95% of the individuals, you could
discard all SNPs with a <code>prop_mis</code> over <code>0.05</code>.</p>
<p>The value of <code>maxpostprob</code> is a very intuitive measure
for the quality of the genotype estimate of an individual.
This is the posterior probability of correctly genotyping
the individual when using <code>geno</code> (the posterior mode)
as the genotype estimate. So if you want to correctly genotype,
say, 95% of individuals, you could discard all individuals
with a <code>maxpostprob</code> of under <code>0.95</code>. However, if you are
just going to impute missing genotypes later, you might consider
not discarding any individuals as <code>flexdog</code>'s genotype estimates will
probably be more accurate than other more naive approaches, such
as imputing using the grand mean.</p>
<p>In most datasets I've examined, allelic bias is a major issue. However,
you may fit the model assuming no allelic bias by setting
<code>update_bias = FALSE</code> and <code>bias_init = 1</code>.</p>
<p>Prior to using <code>flexdog</code>, during the read-mapping step,
you could try to get rid of allelic bias by
using WASP (<a href='https://doi.org/10.1101/011221'>https://doi.org/10.1101/011221</a>). If you are successful
in removing the allelic bias (because its only source was the read-mapping
step), then setting <code>update_bias = FALSE</code> and <code>bias_init = 1</code>
would be reasonable. You can visually inspect SNPs for bias by
using <code><a href='plot_geno.html'>plot_geno</a></code>.</p>
<p><code>flexdog</code>, like most methods, is invariant to which allele you
label as the "reference" and which you label as the "alternative".
That is, if you set <code>refvec</code> with the number of alternative
read-counts, then the resulting genotype estimates
will be the estimated allele dosage of the alternative allele.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Gerard, D., Ferrão, L. F. V., Garcia, A. A. F., &amp; Stephens, M. (2018). Genotyping Polyploids from Messy Sequencing Data. <em>Genetics</em>, 210(3), 789-807. doi: <a href='https://doi.org/10.1534/genetics.118.301468'>10.1534/genetics.118.301468</a>.</p></li>
<li><p>Gerard, D. and Ferrão, L. F. V. (2019). Priors for Genotyping Polyploids. <em>Bioinformatics</em>. doi: <a href='https://doi.org/10.1093/bioinformatics/btz852'>10.1093/bioinformatics/btz852</a>.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Run <code><a href='https://rdrr.io/r/utils/browseVignettes.html'>browseVignettes(package = "updog")</a></code> in R for example usage.
    Other useful functions include:</p><dl class='dl-horizontal'>
    <dt><code><a href='flexdog_full.html'>flexdog_full</a></code></dt><dd><p>For additional parameter options
          when running <code>flexdog</code>.</p></dd>
    <dt><code><a href='rgeno.html'>rgeno</a></code></dt><dd><p>For simulating genotypes under the allowable
          prior models in <code>flexdog</code>.</p></dd>
    <dt><code><a href='rflexdog.html'>rflexdog</a></code></dt><dd><p>For simulating read-counts under the
          assumed likelihood model in <code>flexdog</code>.</p></dd>
    <dt><code><a href='plot.flexdog.html'>plot.flexdog</a></code></dt><dd><p>For plotting the output of
          <code>flexdog</code>.</p></dd>
    <dt><code><a href='oracle_mis.html'>oracle_mis</a></code></dt><dd><p>For calculating the oracle genotyping
          error rates. This is useful for read-depth calculations
          <em>before</em> collecting data. After you have data, using
          the value of <code>prop_mis</code> is better.</p></dd>
    <dt><code><a href='oracle_cor.html'>oracle_cor</a></code></dt><dd><p>For calculating the correlation
          between the true genotypes and an oracle estimator
          (useful for read-depth calculations <em>before</em>
          collecting data).</p></dd>

</dl>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'>## An S1 population where the first individual</span>
<span class='co'>## is the parent. Fit assuming outliers.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"snpdat"</span>)
<span class='no'>ploidy</span>  <span class='kw'>&lt;-</span> <span class='fl'>6</span>
<span class='no'>refvec</span>  <span class='kw'>&lt;-</span> <span class='no'>snpdat</span>$<span class='no'>counts</span>[<span class='no'>snpdat</span>$<span class='no'>snp</span> <span class='kw'>==</span> <span class='st'>"SNP3"</span>]
<span class='no'>sizevec</span> <span class='kw'>&lt;-</span> <span class='no'>snpdat</span>$<span class='no'>size</span>[<span class='no'>snpdat</span>$<span class='no'>snp</span> <span class='kw'>==</span> <span class='st'>"SNP3"</span>]
<span class='no'>fout</span>    <span class='kw'>&lt;-</span> <span class='fu'>flexdog</span>(<span class='kw'>refvec</span>   <span class='kw'>=</span> <span class='no'>refvec</span>[-<span class='fl'>1</span>],
                   <span class='kw'>sizevec</span>  <span class='kw'>=</span> <span class='no'>sizevec</span>[-<span class='fl'>1</span>],
                   <span class='kw'>ploidy</span>   <span class='kw'>=</span> <span class='no'>ploidy</span>,
                   <span class='kw'>model</span>    <span class='kw'>=</span> <span class='st'>"s1"</span>,
                   <span class='kw'>p1ref</span>    <span class='kw'>=</span> <span class='no'>refvec</span>[<span class='fl'>1</span>],
                   <span class='kw'>p1size</span>   <span class='kw'>=</span> <span class='no'>sizevec</span>[<span class='fl'>1</span>],
                   <span class='kw'>outliers</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;          Fit: 1 of 5 
#&gt; Initial Bias: 0.3678794 
#&gt; Log-Likelihood: -585.1254 
#&gt; Keeping new fit.
#&gt; 
#&gt;          Fit: 2 of 5 
#&gt; Initial Bias: 0.6065307 
#&gt; Log-Likelihood: -585.1255 
#&gt; Keeping old fit.
#&gt; 
#&gt;          Fit: 3 of 5 
#&gt; Initial Bias: 1 
#&gt; Log-Likelihood: -522.7964 
#&gt; Keeping new fit.
#&gt; 
#&gt;          Fit: 4 of 5 
#&gt; Initial Bias: 1.648721 
#&gt; Log-Likelihood: -522.7964 
#&gt; Keeping new fit.
#&gt; 
#&gt;          Fit: 5 of 5 
#&gt; Initial Bias: 2.718282 
#&gt; Log-Likelihood: -522.7964 
#&gt; Keeping old fit.
#&gt; 
#&gt; Done!</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>fout</span>)</div><div class='img'><img src='flexdog-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>

<span class='co'>## A natural population. We will assume a</span>
<span class='co'>## normal prior since there are so few</span>
<span class='co'>## individuals.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"uitdewilligen"</span>)
<span class='no'>ploidy</span>  <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>refvec</span>  <span class='kw'>&lt;-</span> <span class='no'>uitdewilligen</span>$<span class='no'>refmat</span>[, <span class='fl'>1</span>]
<span class='no'>sizevec</span> <span class='kw'>&lt;-</span> <span class='no'>uitdewilligen</span>$<span class='no'>sizemat</span>[, <span class='fl'>1</span>]
<span class='no'>fout</span>    <span class='kw'>&lt;-</span> <span class='fu'>flexdog</span>(<span class='kw'>refvec</span>  <span class='kw'>=</span> <span class='no'>refvec</span>,
                   <span class='kw'>sizevec</span> <span class='kw'>=</span> <span class='no'>sizevec</span>,
                   <span class='kw'>ploidy</span>  <span class='kw'>=</span> <span class='no'>ploidy</span>,
                   <span class='kw'>model</span>   <span class='kw'>=</span> <span class='st'>"norm"</span>)</div><div class='output co'>#&gt;          Fit: 1 of 5 
#&gt; Initial Bias: 0.3678794 
#&gt; Log-Likelihood: -14.66905 
#&gt; Keeping new fit.
#&gt; 
#&gt;          Fit: 2 of 5 
#&gt; Initial Bias: 0.6065307 
#&gt; Log-Likelihood: -14.66905 
#&gt; Keeping new fit.
#&gt; 
#&gt;          Fit: 3 of 5 
#&gt; Initial Bias: 1 
#&gt; Log-Likelihood: -15.44144 
#&gt; Keeping old fit.
#&gt; 
#&gt;          Fit: 4 of 5 
#&gt; Initial Bias: 1.648721 
#&gt; Log-Likelihood: -15.44141 
#&gt; Keeping old fit.
#&gt; 
#&gt;          Fit: 5 of 5 
#&gt; Initial Bias: 2.718282 
#&gt; Log-Likelihood: -15.44141 
#&gt; Keeping old fit.
#&gt; 
#&gt; Done!</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>fout</span>)</div><div class='img'><img src='flexdog-2.png' alt='' width='700' height='433' /></div><div class='input'>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>David Gerard</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Gerard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


