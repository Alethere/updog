<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="David Gerard" />

<meta name="date" content="2018-06-11" />

<title>Oracle Calculations</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Oracle Calculations</h1>
<h4 class="author"><em>David Gerard</em></h4>
<h4 class="date"><em>2018-06-11</em></h4>



<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p>We provide some example usage of the oracle calculations available in <code>updog</code>. These are particularly useful for read-depth determination.</p>
</div>
<div id="controlling-misclassification-error" class="section level1">
<h1>Controlling Misclassification Error</h1>
<p>Suppose we have a sample of tetraploid individuals derived from an S1 cross (a single generation of selfing). Using domain expertise (either from previous studies or a pilot analysis), we’ve determined that our sequencing technology will produce relatively clean data. That is, the sequencing error rate will not be too large (say, ~0.001), the bias will be moderate (say, ~0.7 at the most extreme), and the majority of SNPs will have reasonable levels of overdispersion (say, less than 0.01). We want to know how deep we need to sequence.</p>
<p>Using <code>oracle_mis</code>, we can see how deep we need to sequence under the worst-case scenario we want to control (sequencing error rate = 0.001, bias = 0.7, overdispersion = 0.01) in order to obtain a misclassification error rate of at most, say, 0.05.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bias   &lt;-<span class="st"> </span><span class="fl">0.7</span>
od     &lt;-<span class="st"> </span><span class="fl">0.01</span>
seq    &lt;-<span class="st"> </span><span class="fl">0.001</span>
maxerr &lt;-<span class="st"> </span><span class="fl">0.05</span></code></pre></div>
<p>Before we do this, we also need the distribution of the offspring genotypes. We can get this distribution assuming various parental genotypes using the <code>get_q_array</code> function. Typically, error rates will be larger when the allele-frequency is closer to 0.5. So we’ll start in the worst-case scenario of assuming that the parent has 2 copies of the reference allele.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(updog)
ploidy &lt;-<span class="st"> </span><span class="dv">4</span>
pgeno &lt;-<span class="st"> </span><span class="dv">2</span>
gene_dist &lt;-<span class="st"> </span><span class="kw">get_q_array</span>(<span class="dt">ploidy =</span> ploidy)[pgeno <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, pgeno <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, ]</code></pre></div>
<p>This is what the genotype distribution for the offspring looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">data_frame</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span>ploidy, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> gene_dist) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">xend =</span> x, <span class="dt">yend =</span> yend)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Allele Dosage&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now, we are ready to iterate through read-depth’s until we reach one with an error rate less than 0.05.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err    &lt;-<span class="st"> </span><span class="ot">Inf</span>
depth  &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="cf">while</span>(err <span class="op">&gt;</span><span class="st"> </span>maxerr) {
  depth &lt;-<span class="st"> </span>depth <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  err &lt;-<span class="st"> </span><span class="kw">oracle_mis</span>(<span class="dt">n =</span> depth,
                    <span class="dt">ploidy =</span> ploidy,
                    <span class="dt">seq =</span> seq,
                    <span class="dt">bias =</span> bias,
                    <span class="dt">od =</span> od,
                    <span class="dt">dist =</span> gene_dist)
}
depth
<span class="co">#&gt; [1] 90</span></code></pre></div>
<p>Looks like we need a depth of 90 in order to get a misclassification error rate under 0.05.</p>
<p>Note that <code>oracle_mis</code> returns the <strong>best misclassification error rate possible</strong> under these conditions (<code>ploidy</code> = 4, <code>bias</code> = 0.7, <code>seq</code> = 0.001, <code>od</code> = 0.01, and <code>pgeno</code> = 2). In your actual analysis, you will have a worse misclassification error rate than that returned by <code>oracle_mis</code>. However, if you have a lot of individuals in your sample, then this will act as a reasonable approximation to the error rate. In general though, you should sequence a little deeper than suggested by <code>oracle_mis</code>.</p>
</div>
<div id="visualizing-the-joint-distribution" class="section level1">
<h1>Visualizing the Joint Distribution</h1>
<p>Suppose we only have a budget to sequence to a depth of 30. Then what errors can we expect? We can use <code>oracle_joint</code> and <code>oracle_plot</code> to visualize the errors we can expect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depth &lt;-<span class="st"> </span><span class="dv">30</span>
jd &lt;-<span class="st"> </span><span class="kw">oracle_joint</span>(<span class="dt">n =</span> depth,
                   <span class="dt">ploidy =</span> ploidy,
                   <span class="dt">seq =</span> seq,
                   <span class="dt">bias =</span> bias,
                   <span class="dt">od =</span> od,
                   <span class="dt">dist =</span> gene_dist)
<span class="kw">oracle_plot</span>(jd)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Most of the errors will be mistakes between genotypes 2/3 and mistakes between genotypes 1/2.</p>
<p>Even though the misclassification error rate is pretty high (0.14), the correlation of the oracle estimator with the true genotype is pretty reasonable (0.89). You can obtain this using the <code>oracle_cor</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ocorr &lt;-<span class="st"> </span><span class="kw">oracle_cor</span>(<span class="dt">n =</span> depth,
                    <span class="dt">ploidy =</span> ploidy,
                    <span class="dt">seq =</span> seq,
                    <span class="dt">bias =</span> bias,
                    <span class="dt">od =</span> od,
                    <span class="dt">dist =</span> gene_dist)
ocorr
<span class="co">#&gt; [1] 0.8935</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-gerard2018harnessing">
<p>Gerard, David, Luis Felipe Ventorim Ferrão, Antonio Augusto Franco Garcia, and Matthew Stephens. 2018. “Harnessing Empirical Bayes and Mendelian Segregation for Genotyping Autopolyploids from Messy Sequencing Data.” <em>bioRxiv</em>. Cold Spring Harbor Laboratory. doi:<a href="https://doi.org/10.1101/281550">10.1101/281550</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
